matrix:
  include:
  - os: linux
    dist: trusty
    sudo: required
    language: python
    python: 2.7
    services:
    - docker
    env:
    - DOCKER_OS=ubuntu16.04
  - os: linux
    dist: trusty
    sudo: required
    language: python
    python: 3.5
    services:
    - docker
    env:
    - DOCKER_OS=ubuntu16.04
  - os: linux
    dist: trusty
    sudo: required
    language: python
    python: 2.7
    services:
    - docker
    env:
    - DOCKER_OS=centos7
  - os: linux
    dist: trusty
    sudo: required
    language: python
    python: 3.5
    services:
    - docker
    env:
    - DOCKER_OS=centos7
  - os: osx
    osx_image: xcode7.2
    language: generic
    python: 2.7
    env:
    - PYTHON_VERSION=2.7
  - os: osx
    osx_image: xcode7.2
    language: generic
    python: 3.5
    env:
    - PYTHON_VERSION=3.5

before_install:
- pwd

install:
- if [ "$TRAVIS_OS_NAME" == "linux" ]; then docker build -f Dockerfile-$DOCKER_OS-py${TRAVIS_PYTHON_VERSION}
  -t fredrikaverpil/pyside2-$DOCKER_OS-py${TRAVIS_PYTHON_VERSION} . ; fi
- if [ "$TRAVIS_OS_NAME" == "linux" ]; then docker run --rm -v $(pwd):/pyside-setup/dist
  fredrikaverpil/pyside2-$DOCKER_OS-py${TRAVIS_PYTHON_VERSION} ; fi
- if [ "$TRAVIS_OS_NAME" == "osx" ]; then chmod +x build_osx_py${PYTHON_VERSION}.sh
  ; fi
- if [ "$TRAVIS_OS_NAME" == "osx" ]; then ./build_osx_py${PYTHON_VERSION}.sh ; fi
- if [ "$TRAVIS_OS_NAME" == "osx" ]; then mv ~/pyside-setup/dist/*.whl . ; fi

before_script:
- pwd

script:
- ls -al *.whl

deploy:
  provider: bintray
  file: '*.whl'
  user: fredrikaverpil
  key:
    secure: cRLtxBhIu2X/MXYgUednLWmhy/1i0VNa0pHTEv3zuvpqENMsR/lyFuhTize+EqZaD/Ike+TQuG7Vo1OEN01wNITQe8YXNuQPRYfrCKdNLb+vJL9MwNDRRIjlYFyChRD7XJifzWlpiEsJ6WKKJsI+h2ONlQYHyoAQ78tpeG0PkqeIidUtwncaDmJeWEbfTzaPZmoUJS2UznF7Gv6z1Oz6iNXSFVM+sPUzwA59lioM+btuG8CymdSfQxZXTCXRHALC4cLq4B+ut6pcB3CqVhvi3MyNwydX/U5ABDVUM14BHgSYKDCvqthKdq7Fe35yrHWoGeBi+E42o0ee8lwEyj8ZJHlBWkUeKyA3jwHDyb4Aa93TTKvjv6000Vnsd26kKObyVqu5QqQN/vx2gz4JbiXt62GD4YTBVx/T2P3LU8efRpPXf0WWuVnQqwBC9jVWjr1ELjOo4kXbL9q4OHNh/e/aPIbrv2MhpQvw6aqvA2UMZoMqP8Yv5TZkH3ETnYGCdtGbV2nHtFegqp6Cmph+J6nPcGQipdF8OvTgSwxlQay+OMTD5uVRNzQ/Z6VXHgAbqVwEXHNywkZ2ZYXb6U/wuldIyouQoW3m69F+GTREojgbbgpoyj7wF4CkQ5iAmcnpxZBz8scv5uEKVvNwJonc53bCZb9qMQlRFhKWgHRtwtLnJL0=
  dry-run: true
  on:
    all_branches: true
